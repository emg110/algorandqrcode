<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>Algorand QRCode</title>
  <script src="js/qrcode.js"></script> <!-- This doesn't exist in the examples, Build the project before use. -->
  
  <style>
    * {
      box-sizing: border-box;
      font-family: Arial, Helvetica, sans-serif;
    }

    .title {
      text-align: center;
    }

    body {
      margin: 0px;
    }

    input[type=text],
    select,
    textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
      resize: vertical;
    }

    label {
      padding: 12px 12px 12px 0;
      display: inline-block;
    }


    .container {
      border-radius: 5px;
      background-color: #f2f2f2;
      padding: 20px;
    }

    .col-5 {
      float: left;
      width: 5%;
      margin-top: 6px;
    }

    .col-13 {
      float: left;
      width: 13%;
      margin-top: 6px;
      text-align: right;
      margin-right: 20px;
    }

    .col-15 {
      float: left;
      width: 15%;
      /* margin-top: 6px; */
      text-align: right;
      margin-right: 20px;
    }

    .col-35 {
      float: left;
      width: 35%;
      margin-top: 6px;
    }

    .col-25 {
      float: left;
      width: 25%;
      margin-top: 16px;
    }

    .col-75 {
      float: left;
      width: 75%;
      margin-top: 6px;
    }

    .row:after {
      content: "";
      display: table;
      clear: both;
    }

    .qrcode-image {
      border: 1px solid #ccc;
    }

    .button-div {
      display:block;
      text-align: right;
      margin-top: 50px;
    }

    .qrcode-div {
      display:block;
      text-align: center;
      margin-top: 25px;
    }

    #generate-button {
      padding: 10px;
      display: inline-block;
    }

    #clear-logo-button {
      padding: 10px;
      display: inline-block;
    }

    .App-logo {
      height: 80px;
    }

    .App-header {
      background-color: #222;
      padding: 20px;
      color: white;
    }

    .App-header .title {
      margin-top: 40px;
    }



    @media screen and (max-width: 600px) {

      .col-5,
      .col-15,
      .col-25,
      .col-35,
      .col-75 {
        width: 100%;
        margin-top: 0;
        text-align: left;
        vertical-align: middle;
      }

      .col-13 {
        text-align: left;
        vertical-align: middle;
      }

      .button-div {
        margin-top: 20px;
        text-align: center;
        vertical-align: middle;
      }

      .qrcode-div {
        text-align: center;
        vertical-align: middle;
      }
    }
  </style>
</head>

<body>
  <a href="https://github.com/emg110/algorand-qrcode" class="github-corner" aria-label="View source on GitHub"><svg
      width="80" height="80" viewBox="0 0 250 250"
      style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
      <path
        d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
        fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
      <path
        d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
        fill="currentColor" class="octo-body"></path>
    </svg></a>
  <style>
    .github-corner:hover .octo-arm {
      animation: octocat-wave 560ms ease-in-out
    }

    @keyframes octocat-wave {

      0%,
      100% {
        transform: rotate(0)
      }

      20%,
      60% {
        transform: rotate(-25deg)
      }

      40%,
      80% {
        transform: rotate(10deg)
      }
    }

    @media (max-width:500px) {
      .github-corner:hover .octo-arm {
        animation: none
      }

      .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }
    }
  </style>
  <div class="App-header">
    <img src="./images/logo.png" class="App-logo" alt="Algorand QR Code">
    <h1>Algorand QR Code <h4>simple web demo</h4>
    </h1>

  </div>
  <div class="container">
    <div class="row">
      <div class="col-15">
        <label for="label">Address</label>
      </div>
      <div class="col-75">
        <input class="wallet-input" id="wallet" type="text" name="wallet"
          value="AMESZ5UX7ZJL5M6GYEHXM63OMFCPOJ23UXCQ6CVTI2HVX6WUELYIY262WI" placeholder="Wallet address" />
      </div>
    </div>

    <div class="row">
      <div class="col-15">
        <label for="label">Label</label>
      </div>
      <div class="col-75">
        <input id="label" type="text" name="label" value="emg110@gmail.com" placeholder="Label..." />
      </div>
    </div>

    <div class="row">
      <div class="col-15">
        <label for="amount">Amount</label>
      </div>
      <div class="col-25">
        <input id="amount" type="number" name="amount" min="1" value="0.1" />
      </div>
      <div class="col-15">
        <label for="asset">Asset ID</label>
      </div>
      <div class="col-25">
        <input id="asset" type="number" name="asset" placeholder="Asset ID (Numeric)" />
      </div>
    </div>

    <div class="row">
     
      <div class="col-15">
        <label for="note">Note</label>
      </div>
      <div class="col-75">
        <input id="note" type="text" name="note" placeholder="Note..." value="I have set my network into TESTNET!" />
      </div>
    </div>

    <div class="row">
      <div class="col-15">
        <label for="xnote">XNote</label>
      </div>
      <div class="col-25">
        <input id="xnote" type="checkbox" name="xnote" />
      </div>
      <div class="col-13">
        <label for="inverse">Inverse</label>
      </div>
      <div class="col-25">
        <input id="inverse" type="checkbox" name="inverse" />
      </div>
    </div>



    <div class="row">
      <div class="col-15">
        <label for="version">Version</label>
      </div>
      <div class="col-75">
        <select id="version" name="version">
          <option>Auto</option>
        </select>
      </div>
    </div>

    <div class="row">      
      <div class="col-15">
        <label for="errorLevel">Error Correction</label>
      </div>
      <div class="col-75">
        <select id="errorLevel" name="errorLevel">
          <option>Default (Medium)</option>
          <option>Low</option>
          <option>Medium</option>
          <option>Quartile</option>
          <option>High</option>
        </select>
      </div>
    </div>
    <div class="row">      
      <div class="col-15">
        <label for="margin">Margin</label>
      </div>
      <div class="col-25">
        <input id="margin" type="number" name="margin" min="4" value="4" />
      </div>
      <div class="col-15">
        <label for="logoSize">Center Logo Size (16-64)</label>
      </div>
      <div class="col-25">
        <input id="logo-size" type="number" name="logoSize" min="16" value="32" />
      </div>
    </div>

    <div class="row">
      <div class="col-15">
        <label for="lightColor">Light color</label>
      </div>
      <div class="col-25">
        <input id="lightColor" type="color" name="light" value="#ffffff" />
      </div>
      <div class="col-13">
        <label for="darkColor">Dark color</label>
      </div>
      <div class="col-25">
        <input id="darkColor" type="color" name="dark" value="#000000" />
      </div>


    </div>
    <div class="row">
      <div class="col-15">
        <label for="withBgLogo">Background Logo</label>
      </div>
      <div class="col-25">
        <input id="with-bg-logo" type="checkbox" name="withBgLogo" />
      </div>
      <div class="col-13">
        <label for="withLogo">Centered Logo</label>
      </div>
      <div class="col-25">
        <input id="with-centered-logo" type="checkbox" name="withLogo" />
      </div>
    </div>
    <div id="logoBgImageRow" class="row">
      <div class="col-15">
        <label for="logoBgImage">QR Code Background Image</label>
      </div>
      <div class="col-25">
        <input id="logoBgImage" type="file" onchange="previewFileBg()">

      </div>
      <div class="col-13">
        <label for="logoBgImagePreview">Background Image Preview</label>
      </div>
      <div class="col-25">
        <img id="logoBgImagePreview" src="./images/no-image.jpg" width="100" alt="Image preview...">

      </div>


    </div>
    <div id="logoImageRow" class="row">
      <div class="col-15">
        <label for="logoImage">QR Code center Image</label>
      </div>
      <div class="col-25">
        <input id="logoImage" type="file" onchange="previewFile()">

      </div>
      <div class="col-13">
        <label for="logoImagePreview">Center Image Preview</label>
      </div>
      <div class="col-25">
        <img id="logoImagePreview" src="./images/no-image.jpg" width="100" alt="Image preview...">

      </div>


    </div>

    <div class="row">

      <div class="col-35 button-div">
        <button id="generate-button">Create Algorand QR Code</button>
        <br />
        <button id="clear-logo-button">Clear Logo Images</button>
      </div>
      <div class="col-35 qrcode-div">
        <p id="error" class="error"></p>

        <canvas style="border-bottom:10px solid rgb(115, 175, 245); height: 196px;width:196px" id="canvas"
          class="qrcode-image"></canvas>
        <div style="min-width:100%;font-size:0.7em;margin:auto;display:block;text-align:center;"
          class="algorand-uri-container">
          <div class="control">
            <label style="text-align:center;" for="input-algorand-address">Generated Algorand URI:</label>
            
          </div>
          
        </div>
        
      </div>
    </div>
    <input style="width:100%; bottom:0; margin:auto; display:block;text-align:center" class="algorand-generated-uri" id="algorand-uri-result" placeholder="algorand://"/>

  </div>

  <script>
    var errorEl = document.getElementById('error')
    var versionEl = document.getElementById('version')
    var errorLevelEl = document.getElementById('errorLevel')
    /* var modeEl = document.getElementById('mode') */
    var marginEl = document.getElementById('margin')
    var lightColorEl = document.getElementById('lightColor')
    var darkColorEl = document.getElementById('darkColor')
    var canvasEl = document.getElementById('canvas')
    var walletEl = document.getElementById('wallet')
    var labelEl = document.getElementById('label')
    var noteEl = document.getElementById('note')
    var xnoteEl = document.getElementById('xnote')
    var amountEl = document.getElementById('amount')
    var inverseEl = document.getElementById('inverse')
    var assetEl = document.getElementById('asset')

    var withLogoEl = document.getElementById('with-centered-logo')
    var logoImageEl = document.getElementById('logoImage')
    var logoImagePreviewEl = document.getElementById('logoImagePreview')

    var withBgLogoEl = document.getElementById('with-bg-logo')
    var logoBgImageEl = document.getElementById('logoBgImage')
    var logoBgImagePreviewEl = document.getElementById('logoBgImagePreview')


    var logoBgImageRow = document.getElementById('logoBgImageRow')
    var logoImageRow = document.getElementById('logoImageRow')



    var clearButton = document.getElementById('clear-logo-button')
    var readerResultsBg = null;
    var readerResults = null;

    var generateButton = document.getElementById('generate-button')
    var logoSizeEl = document.getElementById('logo-size')

    function previewFileBg() {

      const fileBg = logoBgImageEl.files[0];
      const readerBg = new FileReader();

      readerBg.addEventListener("load", function () {

        readerResultsBg = readerBg.result;
        logoBgImagePreviewEl.src = readerBg.result;
      }, false);
      if (fileBg) {
        readerBg.readAsDataURL(fileBg);
      }
    }
    function previewFile() {

      const file = logoImageEl.files[0];
      const reader = new FileReader();

      reader.addEventListener("load", function () {

        readerResults = reader.result;
        logoImagePreviewEl.src = reader.result;
      }, false);
      if (file) {
        reader.readAsDataURL(file);
      }
    }
    function clearLogo() {

      logoImageEl.value = '';
      logoBgImageEl.value = '';
      readerResults = null;
      readerResultsBg = null;
      logoBgImagePreviewEl.src = "./images/no-image.jpg";
      logoImagePreviewEl.src = "./images/no-image.jpg";

    }
    /**
     *
     *
     * @function
     * @name drawQR
     * @desc The drawQR function is called to render QR Code with canvas and based on configuration params via HTML form.
     */
    function drawQR() {
      errorEl.style.display = 'none'
      canvasEl.style.display = 'block'
      // Declaring options and getting values from HTML form elements
      let options = {
        wallet: walletEl.value,
        amount: amountEl.value,
        note: noteEl.value,
        xnote: xnoteEl.checked,
        withBgLogo: withBgLogoEl.checked,
        withLogo: withLogoEl.checked,
        bgLogo: withBgLogoEl.checked ? readerResultsBg : null,
        logo: withLogoEl.checked ? readerResults : null,
        logoSize: logoSizeEl.value,
        html: false,
        label: labelEl.value,
        asset: assetEl.value,
        inverse: inverseEl.checked,
        version: versionEl.value,
        errorCorrectionLevel: errorLevelEl.options[errorLevelEl.selectedIndex].text,
        margin: marginEl.value,
        color: {
          light: lightColorEl.value,
          dark: darkColorEl.value
        },
      }

      options.mode = 'Auto';
      /**
       *
       *
       * @class QRCode
       * @method toCanvas
       * @desc The toCanvas method of QRCode will render a QR Code into canvas element argeument using options argument
       * @param {*} canvasEl
       * @param {*} options
       * @return {Promise} 
       */
      QRCode.toCanvas(canvasEl, options).then((res) => {
        canvasEl.style.display = 'inline'
        console.log(res[1])
        var algoUriEl = document.getElementById('algorand-uri-result')
        if (algoUriEl) {
          algoUriEl.value = res[1]
        }

      }).catch((error) => {
        if (error) {
          canvasEl.style.display = 'none'
          errorEl.style.display = 'inline'
          errorEl.textContent = error
        }
      })
    }


    //Listens for Generate button click
    generateButton.addEventListener('click', drawQR, false)
    clearButton.addEventListener('click', clearLogo, false)
    logoImageRow.hidden = true
    logoBgImageRow.hidden = true
    clearButton.style.display = 'none'
    logoSizeEl.disabled = true
    
    withBgLogoEl.addEventListener('change', function () {
      if (this.checked) {
        logoBgImageRow.hidden = false
        clearButton.style.display = 'inline-block'
        logoSizeEl.disabled = true

      } else {
        logoBgImageRow.hidden = true
        clearButton.style.display = 'none'
        

      }
    });
    withLogoEl.addEventListener('change', function () {
      if (this.checked) {
        logoImageRow.hidden = false
        clearButton.style.display = 'inline-block'
        logoSizeEl.disabled = false

      } else {
        logoImageRow.hidden = true
        clearButton.style.display = 'none'
        logoSizeEl.disabled = true

      }
    });

    
    for (var i = 1; i <= 40; i++) {
      versionEl.options[versionEl.options.length] = new Option(i.toString(), i)
    }


  </script>

</body>

</html>